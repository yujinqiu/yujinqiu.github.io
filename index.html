

<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8">
    <base href="http://yujinqiu.github.io">
    <title>Engineer&#39;s Draft</title>
    <link rel="canonical" href="http://yujinqiu.github.io/">
    <link href="http://yujinqiu.github.io/index.xml/" rel="alternate" type="application/rss+xml" title="Engineer&#39;s Draft" />

    

<link rel="stylesheet" href="/css/poole.css">

<link rel="stylesheet" href="/css/lanyon.css">

</head>
  <body class="theme-base-0b" lang="en">

  


<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">

  <nav class="sidebar-nav">
    <p><img src="img/logo.png" width="80"></p>
    <a class="sidebar-nav-item" href="/">Home</a>

    <a class="sidebar-nav-item" href="/posts">Blog</a>

    <a class="sidebar-nav-item" href="https://github.com/yujinqiu">Github</a>
  </nav>

  <div class="sidebar-item">
    <p>
      Powered by <a href="http://hugo.spf13.com">Hugo</a>. Design reused from <a href="https://github.com/spencerlyon2">Spencer Lyon</a> which was modified from this Jekyl theme <a href="http://lanyon.getpoole.com">Lanyon</a> under this <a href="https://github.com/spencerlyon2/hugo_gh_blog/blob/master/LICENSE">licence</a>.
    </p>
  </div>
</div>




  
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="engineer's draft">Engineer's Draft</a>
          </h3>
          <hr>
        </div>
      </div>

      <div class="container content">

        
        <h1 class="post-title">Top10 Posts</h1>
        <section id="main">
          <ul id="list">
            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/GolangDraft/'> GolangDraft</a> </h2>
      <div class="meta">Fri, Dec 12, 2014</div>
    </header>

    Golang 相关 tools 安装 背景 在学习 golang 过程中, 看到 Rob Pike 大神的 slide , 感觉炫酷. 安装过程如下: go get golang.org/x/tools/cmd/present 注意 如果期望手工 build, 进入目录: go/src/golang.org/x/tools/cmd/present 不要搞错.
    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/GolangDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/NmapHack/'> Nmap Draft</a> </h2>
      <div class="meta">Thu, Dec 4, 2014</div>
    </header>

    <p>#nmap 简单介绍</p>

<p>本文的切入点:hacker使用Nmap的流程角度来介绍如何掌握Nmap这个强大的工具,帮助安全管理员发现自己网站的漏洞, 并逐步加固自己的安全.</p>

<p>nmap(network mapper) 主要用途<br />
- 网络发现<br />
- 安全扫描
- 端口扫描
- 网络审查</p>

<h3>nmap 命令选项</h3>

<pre><code>nmap [-s (Scan Type)] [Options] {target specification}
</code></pre>

<h2>Let&rsquo;s start hack</h2>

<h3>确定网络的主机</h3>

<p>hacker使用Nmap来扫描整个网络。</p>

<pre><code>nmap -sP 192.168.1.0/24  
</code></pre>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/NmapHack/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/MysqlDraft/'> MysqlDraft</a> </h2>
      <div class="meta">Thu, Dec 4, 2014</div>
    </header>

    <h2>Mysql多列去重</h2>

<h3>背景</h3>

<p>在项目中通常需要我们对数据进行去重, 第一反应应该是使用<code>distinct</code> 来进行去重, 假设数据如下</p>

<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>age</th>
</tr>
</thead>

<tbody>
<tr>
<td>1</td>
<td>monalisa</td>
<td>100</td>
</tr>

<tr>
<td>2</td>
<td>foo</td>
<td>100</td>
</tr>

<tr>
<td>3</td>
<td>monalisa</td>
<td>26</td>
</tr>

<tr>
<td>4</td>
<td>foo</td>
<td>100</td>
</tr>

<tr>
<td>5</td>
<td>bar</td>
<td>100</td>
</tr>

<tr>
<td>6</td>
<td>test</td>
<td>100</td>
</tr>

<tr>
<td>7</td>
<td>demo</td>
<td>100</td>
</tr>
</tbody>
</table>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/MysqlDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/GitDraft/'> Git Draft</a> </h2>
      <div class="meta">Tue, Nov 25, 2014</div>
    </header>

    <h1>Git</h1>

<h2>原子提交</h2>

<p>在我们修改文件的时候, 通常是希望一次提交只包含该次功能修改相关的操作.<br />
但是如果一个文件包含多个操作该怎么办 ?<br />
或者你的一个程序文件里边,为了调试写了很多的log日志输出, 你不希望这些语句ci 到server上, 该怎么办 ?</p>

<p><code>git add -p</code> 能够解决上面的场景(虽然已经add 过,还是需要add 到 stage 进去).<br />
执行之后会提示:</p>

<pre><code>Stage this hunk [y,n,q,a,d,/,e,?]?
</code></pre>

<p>hit <code>s</code> to split whatever change into smaller chunks. This only works if there is at least one unchanged line in the &ldquo;middle&rdquo; of the hunk, which is where hunk will be split<br />
then hit <code>y</code> to stage that chunk<br />
or <code>n</code> to not stage that hunk<br />
or <code>e</code> to manually edit the chunk (useful when git can&rsquo;t split it automatically)<br />
and <code>d</code> to exit or go to the next file.<br />
Use <code>?</code> to get the whole list of available options.</p>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/GitDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/ParallelDraft/'> CliDraft</a> </h2>
      <div class="meta">Tue, Nov 25, 2014</div>
    </header>

    <h1>Parallel(并行你的工作2)</h1>

<p>今天看到看到一篇介绍Parallel 的文章<a href="http://www.rankfocus.com/use-cpu-cores-linux-commands/">Use multiple CPU Cores with your Linux commands — awk, sed, bzip2, grep, wc, etc.</a>, 感觉和实际工作的没有太大的帮助, 因为平时其实很少去压缩和解压缩超大的文件. 因此下面主要结合个人的工作经验,总结几条Parallel的工作.
下面看一下Parallel的图片,感觉有点眼花,很有心理学的图片效果, 相信我Parallel 是一个值得你学习的命令, 所谓事半功倍说的就是它.</p>

<p><img src="http://www.gnu.org/software/parallel/logo-gray+black300.png" alt="" />
</p>

<h2>典型场景1</h2>

<p>在日常运维工作中,为了管理大量的机器(1k,1w台机器)我们通常搭建一台中心控制机器, 该机器和线上所有的机器有<a href="http://todo">信任关系</a>, 因此常见的工作就是在中心控制机器上顺序登录各台机器执行命令. 举一个简单的例子, 获取机器的启动时间 <code>uptime</code> . 考虑到机器的规模,假设是1万台, 我们基本上跑一下要消耗3-5min.</p>

<p>为了解决上面的问题,我曾经学习了一下 <code>xargs</code> 命令, 已经能够基本上满足我的要求. 假设机器的列表在 machines 文件内, 那么通过以下命令</p>

<p><code>cat machines | xargs -i ssh {} &quot; uptime &quot;</code></p>

<p>上面的命令是逐台机器执行, 好处就是可以省略在bash 里边输入各种 for 循环. 上面的效果和下面的命令一致
&gt;
for host in $( &lt; machines ) ; do ssh ${host} &ldquo; uptime &rdquo; ;done</p>

<p>如果需要并行执行应该怎么搞? 答案很简单翻一下 xargs 的man 手册你会发现有一个<code>-P</code> 选项, 表示并发度
<code>-P 0</code> 表示全部并发.  -P 10 表示10台并发 (<strong>在运维工程中通常需要考虑控制并发度,特别是在日志下载的时候,因为进程会出现宽度被打满的case,要特别注意</strong>)
因此</p>

<p><code>cat machines | xargs -i -P 0 ssh {} &quot; uptime &quot;</code></p>

<p>就能实现全部并发. 上面的命令你执行之后会发现由于是并行执行, 因此输出基本上是乱序的. 如果某一台机器执行错误,那么基本上很难定位到是哪台.  所以个人认为 xargs 在进行简单的并行,比如批量重启服务,分发大量小文件还是蛮不错的. 我最常用的命令组合是,来实现快速的文件分发</p>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/ParallelDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/Apple/'> AppleDraft</a> </h2>
      <div class="meta">Tue, Nov 25, 2014</div>
    </header>

    <h1>Apple</h1>

<h2>iphone 屏幕小白点怎么开启?</h2>

<p>看到别人的屏幕有一个小白点, 点击之后出现siri, device, favorites 和 home 怎么打开?<br />
那个东西叫Assistive Touch , 在 /setting/general/Accessibility/AssistiveTouch 里边可以打开.</p>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/Apple/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/Mac/'> Mac os X Draft</a> </h2>
      <div class="meta">Tue, Nov 25, 2014</div>
    </header>

    <p>#Mac os X
##Yosemite 升级之后应该进行什么操作?<br />
1. 从 mavericks 升级到 mac os x 之后, 会遇到一些比较诡异的问题(比如找不到 clang), 下面的命令会帮助你提前避免一些问题.</p>

<pre><code class="language-bash">sudo xcode-select --install  
sudo xcode-select --switch /Applications/Xcode.app   
sudo xcodebuild -license  
sudo gem update --system  
sudo gem install xcodeproj   
sudo brew update   
</code></pre>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/Mac/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/SSHDraft/'> SSHDraft</a> </h2>
      <div class="meta">Sun, Nov 23, 2014</div>
    </header>

    <h2>Black Magic Of SSH</h2>

<h3>绑定本地端口( Dynamic Port Forwarding)</h3>

<p>其实本质上就是一个 SOCKS5 proxy<br />
ssh 通过加密传输数据, 特别适合**国情, 加入我们要让8080 端口的数据, 全部通过 SSH  加密转发到远程主机上</p>

<pre><code>ssh  -D 8080 user@host
</code></pre>

<h4>应用场景</h4>

<p>在咖啡厅等公共场所, 为了上网安全, 可以使用 ssh动态转发来保证安全.</p>

<h3>本地端口转发( Local Port Forwarding)</h3>

<h4>背景</h4>

<p>公司从安全性上考虑, 通常会隔离网络, 不允许直接访问, 简单拓扑如下:</p>

<pre><code>          host2
host1 --&gt;  X  --&gt; host3
</code></pre>

<p>host1 无法直接访问 host3, host1 可以访问 host2, host2 可以访问 host3.<br />
可以通过 ssh 的 <strong>本地端口转发</strong> 来进行</p>

<pre><code>ssh -L 2121:host3:21 user@host2
</code></pre>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/SSHDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/fileserver/'> fileserver</a> </h2>
      <div class="meta">Sun, Nov 23, 2014</div>
    </header>

    <h1>文件服务器</h1>

<h2>背景</h2>

<p>我们经常需要下载远程的一台服务器的一个文件, 比如临时线上的某台服务器的一个日志文件需要下载到本地 windows, 没有办法使用 scp, 搭建一个 ftp 又太费劲.</p>

<h3>解决方案</h3>

<h4>python</h4>

<pre><code>python -m SimpleHTTPServer 8080
</code></pre>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/fileserver/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
            

<article class="post">
    <header>
      <h2><a href='http://yujinqiu.github.io/posts/CliDraft/'> CliDraft</a> </h2>
      <div class="meta">Wed, Nov 19, 2014</div>
    </header>

    <h2>命令行控</h2>

<h3>ubuntu (命令行)</h3>

<h4>moc(music on console)</h4>

<p>安装命令 <code>sudo apt-get -y install  moc</code></p>

<h4>特点</h4>

<p>mod 很类似 tmux 能够attach(输入命令<code>mocp</code>) 和 detach(<code>q</code>)</p>

<p>特点:<br />
1. &gt;  音量increase  &lt; 音量 decrease<br />
2. <code>h</code> for help<br />
3. <code>Q</code> for quit</p>

<h3>MAC</h3>

<h4>afplay(Audio File Play)</h4>

<p>很简单的命令, 帮助文档就一个选项<code>-h</code></p>

<pre><code>{-t | --time} TIME  
    play for TIME seconds
{-r | --rate} RATE
    play at playback rate
{-q | --rQuality} QUALITY
    set the quality used for rate-scaled playback (default is 0 - low quality, 1 - high quality)
</code></pre>

    <footer style="text-align:right; ">
        <a href='http://yujinqiu.github.io/posts/CliDraft/'><nobr>Read more →</nobr></a>
    </footer>
    <hr/>
</article>

            
          </ul>
        </section>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>



<div class="container content">
<footer>
</footer>
</div>

</body>
</html>

